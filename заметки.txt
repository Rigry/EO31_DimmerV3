МО-пятьсот11
    старый диммер без доработок
    не измерял корректно ток, тк резистор заряда равен резистору разряда
    заменил rпятнадцать на 1кОм.
    напряжение на ацп при нулевом токе 2.2 В
    изменяю на режим измерения от vcc, тк 2,пятьдесят6 внутреннего будет мало

    #define MIN_CUR		1100    // при котором включаеться стабилизация (половина от номинала)
    в режим стабилизации так и не вошли.

    надо проверить значения с АЦП
    установил проверку на 2.пять вольта, не сработало

    проверяю входим ли в прерывание по АЦП - входим

    в bufADC даже 10 не попадает, но там и не ноль.

    использую еепром для отладки, буду записывать последние 20 измерений
    еепром показал, что в bufADC записываются значения 64-66 (без включения генератора)
    это соответсвует 66/2пятьпять*пять=1,2семь в, хотя по факту там 2,2
    при включенном генераторе значения 9семь-99

    забиваю на расчеты и вставляю имперические числа
    проверю только сумму значений
    809 при нулевом токе
    ~1214 при включенном генераторе
    ставлю минимальный ток, при котором стабилизирует - 900,
    стабилизацию подберу по ходу, пока 1100

    стабилизация не работала, пока я не перенес
        static uint16_t curMeasSumm = 0;
    из бесконечного цикла в глобальные переменные
    со статиком еще поразбираться надо